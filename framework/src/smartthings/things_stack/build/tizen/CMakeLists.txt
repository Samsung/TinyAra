CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(test)

INCLUDE(FindPkgConfig)

# Options
# Build type
IF(NOT CMAKE_BUILD_TYPE)
    SET(CMAKE_BUILD_TYPE "Release")
ENDIF(NOT CMAKE_BUILD_TYPE)

# Compiler flags
SET(CMAKE_C_FLAGS_PROFILING    "-O0 -g -pg")
SET(CMAKE_C_FLAGS_DEBUG        "-O0 -g")
SET(CMAKE_C_FLAGS_RELEASE      "-O2 -g")

# IoTivity Include PATH
SET(IOTIVITY_INCLUDE_PATH        ${PROJECT_SOURCE_DIR}/include/iotivity)
SET(IOTIVITY_CA_INCLUDE_PATH     ${PROJECT_SOURCE_DIR}/include/iotivity/ca)
SET(IOTIVITY_CSDK_INCLUDE_PATH   ${PROJECT_SOURCE_DIR}/include/iotivity/csdk)
SET(IOTIVITY_LOGGER_INCLUDE_PATH ${PROJECT_SOURCE_DIR}/include/iotivity/logger)

# Set compiler options
ADD_DEFINITIONS("-std=c++0x")
ADD_DEFINITIONS("-Wextra")
ADD_DEFINITIONS("-fPIE")
ADD_DEFINITIONS("-Wno-deprecated")

PKG_CHECK_MODULES(TEST_DEP 
    ecore
    REQUIRED
)

SET(TEST_SRCS
    ${PROJECT_SOURCE_DIR}/src/da_aircon_server.cpp
    #${PROJECT_SOURCE_DIR}/src/wifi_test.c
	${PROJECT_SOURCE_DIR}/src/libuart.cpp
	${PROJECT_SOURCE_DIR}/src/libaccontrol.cpp
    #${PROJECT_SOURCE_DIR}/src/iotivityControlleetest.cpp
)

SET(TEST_HEADERS
    ${PROJECT_SOURCE_DIR}/include
    ${IOTIVITY_INCLUDE_PATH}
    ${IOTIVITY_CA_INCLUDE_PATH}
    ${IOTIVITY_CSDK_INCLUDE_PATH}
    ${IOTIVITY_LOGGER_INCLUDE_PATH}
    ${TEST_DEP_INCLUDE_DIRS}
)

#${PROJECT_SOURCE_DIR}/include/iotivity/

ADD_DEFINITIONS(${TEST_DEP_CFLAGS})
INCLUDE_DIRECTORIES(${TEST_HEADERS})
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/include)
LINK_DIRECTORIES(${CMAKE_SOURCE_DIR}/lib)
ADD_EXECUTABLE(${PROJECT_NAME}
    ${TEST_SRCS}
)
TARGET_LINK_LIBRARIES(${PROJECT_NAME} ${TEST_DEP_LDFLAGS} 
    "-ldl -loc -loctbstack" 
    "-loc_logger -lconnectivity_abstraction"
    "-loc_logger_core -lcapi-network-wifi -lglib-2.0"
    ${TEST_DEP_LIBRARIES}
)

INSTALL(TARGETS ${PROJECT_NAME} DESTINATION /controllee PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
